---
layout: post
title: 细说垂直型网络爬虫（六）【解析模块之Jsoup】
category: 细说垂直型网络爬虫
date: 2014-11-29

---

##细说垂直型网络爬虫（六）【解析模块之Jsoup】

标签： 网络爬虫 抓取模块 解析 Jsoup


##Jsoup是用来干什么的
Jsoup是解析Html文档的工具，它可以将String、File、InputStream转化为Document进行解析，此外还可以直接通过URL获取Document。

##常用的方法
>
- 获取Document：
![获取Document](/res/img/blogimg/jsoup_parser.png)

- 获取特定子元素的方法1：
{% highlight java %}
            //根据ID获取节点内容
            Element timeElement = element.getElementById("pubtime");
            //获取包含class属性的所有Element
            Elements classElements = element.getElementsByAttribute("class");
            //获取所有包含有属性以typ开头的Element
            Elements typElements = element.getElementsByAttributeStarting("typ");
            //获取class属性等于info的所有Element
            Elements AVelements = element.getElementsByAttributeValue("class", "info");
            //获取class属性包含info的所有Element
            Elements VCElement = element.getElementsByAttributeValueContaining("class", "info");
            //获取所有class属性以fo结束的Element
            Elements AVEElement = element.getElementsByAttributeValueEnding("class", "fo");
            //获取所有id属性值满足正则表达式gd_(.*)的Element
            Pattern pattern = Pattern.compile("gd_(.*)");
            Elements AVMElements = element.getElementsByAttributeValueMatching("id", pattern);
            //同上
            Elements AVM2Element = element.getElementsByAttributeValueMatching("id", "gd_(.*)");
            //获取所有id属性值不等于info的Element
            Elements AVNElement = element.getElementsByAttributeValueNot("id", "info");
            //获取所有id属性值以gd_开头的Element
            Elements AVSElement = element.getElementsByAttributeValueStarting("id", "gd_");
            //获取所有Class等于info的Element
            Elements CElement = element.getElementsByClass("info");
            //获取序列值等于1的Element
            element.getElementsByIndexEquals(1);
            //获取序列值大于2的Element
            element.getElementsByIndexGreaterThan(2);
            //获取序列值小于3的Element
            element.getElementsByIndexLessThan(3);
            //获取所有A标签
            element.getElementsByTag("a");
            //获取所有文字包含“我有话说”的Element
            element.getElementsContainingOwnText("我有话说");
            //获取包含的文字是
            element.getElementsContainingText("我有话说");
            Pattern p = Pattern.compile("");
            //获取所有文字内容中有符合某个正则表达式的Element
            element.getElementsMatchingOwnText(pattern);
            //同上
            element.getElementsMatchingOwnText("");
            //获取文字内容符合正则表达式的Element
            element.getElementsMatchingText(pattern);
            //同上
            element.getElementsMatchingText("");
{% endhighlight %}

- 获取特定子元素的方法2：
调用select方法
{% highlight java %}
            String cssQuery="";
            element.select(cssQuery);
{% endhighlight %}

Select方法将返回一个Elements集合，并提供一组方法来抽取和处理结果。

Selector选择器概述
tagname: 通过标签查找元素，比如：a
ns|tag: 通过标签在命名空间查找元素，比如：可以用 fb|name 语法来查找 <fb:name> 元素
 #id: 通过ID查找元素，比如：#logo
.class: 通过class名称查找元素，比如：.masthead
[attribute]: 利用属性查找元素，比如：[href]
[^attr]: 利用属性名前缀来查找元素，比如：可以用[^data-] 来查找带有HTML5 Dataset属性的元素
[attr=value]: 利用属性值来查找元素，比如：[width=500]
[attr^=value], [attr$=value], [attr*=value]: 利用匹配属性值开头、结尾或包含属性值来查找元素，比如：[href*=/path/]
[attr~=regex]: 利用属性值匹配正则表达式来查找元素，比如： img[src~=(?i)\.(png|jpe?g)]
*: 这个符号将匹配所有元素
Selector选择器组合使用
el#id: 元素+ID，比如： div#logo
el.class: 元素+class，比如： div.masthead
el[attr]: 元素+class，比如： a[href]
任意组合，比如：a[href].highlight
ancestor child: 查找某个元素下子元素，比如：可以用.body p 查找在"body"元素下的所有 p元素
parent > child: 查找某个父元素下的直接子元素，比如：可以用div.content > p 查找 p 元素，也可以用body > * 查找body标签下所有直接子元素
siblingA + siblingB: 查找在A元素之前第一个同级元素B，比如：div.head + div
siblingA ~ siblingX: 查找A元素之前的同级X元素，比如：h1 ~ p
el, el, el:多个选择器组合，查找匹配任一选择器的唯一元素，例如：div.masthead, div.logo
伪选择器selectors
:lt(n): 查找哪些元素的同级索引值（它的位置在DOM树中是相对于它的父节点）小于n，比如：td:lt(3) 表示小于三列的元素
:gt(n):查找哪些元素的同级索引值大于n，比如： div p:gt(2)表示哪些div中有包含2个以上的p元素
:eq(n): 查找哪些元素的同级索引值与n相等，比如：form input:eq(1)表示包含一个input标签的Form元素
:has(seletor): 查找匹配选择器包含元素的元素，比如：div:has(p)表示哪些div包含了p元素
:not(selector): 查找与选择器不匹配的元素，比如： div:not(.logo) 表示不包含 class=logo 元素的所有 div 列表
:contains(text): 查找包含给定文本的元素，搜索不区分大不写，比如： p:contains(jsoup)
:containsOwn(text): 查找直接包含给定文本的元素
:matches(regex): 查找哪些元素的文本匹配指定的正则表达式，比如：div:matches((?i)login)
:matchesOwn(regex): 查找自身包含文本匹配指定正则表达式的元素













